{"version":3,"sources":["core.js"],"names":["googlePlus","url","window","location","protocol","host","open","$c","document","createElement","bind","$el","getElementById","util","getReferrerTag","ref","referrer","indexOf","href","components","forms","doc","win","focusComments","formComments","className","updateZIPPlaceholder","ZIPLabel","countrySelect","value","setAttribute","toggleCountryField","countryInput","remove","classList","add","countryLabel","removeForm","commitmentForm","clientHeight","setTimeout","handleSigningError","e","errorMessage","errorMessageInfo","removeAttribute","submitted","textContent","type","status","statusText","modals","generateModal","submitButton","handleSigningSuccess","modalContent","share","getElementsByClassName","console","log","innerHTML","querySelector","addEventListener","FreeProgress","tweet","submitForm","event","compilePayload","tags","JSON","parse","push","formData","FormData","append","pathname","stringify","action","replace","loadSignatureResponse","commitmentStatus","preventDefault","XMLHttpRequest","appendChild","send","ga","VARIATION","addEventListeners","init","body","getElementsByTagName","dismissModal","modal","contents","disableOverlayClick","closeModal","overlay","undefined","length","id","i","modalParent","noConnectionModal","message","views","triggerComponents","dataset","split","Countdown","this","date","Date","UTC","getTime","interval","requestAnimationFrame","targets","tick","curTick","start","shareVisibilityTriggered","headlineEl","bodyRect","getBoundingClientRect","elemRect","headlineY","top","listenerFn","pageYOffset","scrollTop","clientTop","alpha","style","backgroundColor","smoothScroll","gl","querySelectorAll","prototype","constants","day","hour","minute","second","padNumber","number","request","stop","setInterval","clearInterval","now","difference","updateDates","days","Math","floor","hours","minutes","seconds","str"],"mappings":"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","file":"core.js","sourcesContent":["/**\n *\n * @source: https://github.com/fightforthefuture/savesecurity.org\n *\n * @licstart  The following is the entire license notice for the\n *  JavaScript code in this page.\n *\n * Copyright (C) Fight for the Future\n *\n *\n * The JavaScript code in this page is free software: you can\n * redistribute it and/or modify it under the terms of the GNU\n * General Public License (GNU GPL) as published by the Free Software\n * Foundation, either version 3 of the License, or (at your option)\n * any later version.  The code is distributed WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.\n *\n * As additional permission under GNU GPL version 3 section 7, you\n * may distribute non-source (e.g., minimized or compacted) forms of\n * that code without the copy of the GNU GPL normally required by\n * section 4, provided you include this license notice and a URL\n * through which recipients can access the Corresponding Source.\n *\n * @licend  The above is the entire license notice\n * for the JavaScript code in this page.\n *\n */\n\n/**\n *  util : random grab bag functions\n */\n\nvar $c  = document.createElement.bind(document);\nvar $el = document.getElementById.bind(document);\n\nutil = {\n  getReferrerTag: function() {\n    var ref = document.referrer;\n    if (ref.indexOf('facebook.com') !== -1)\n      return 'from-facebook';\n    else if (ref.indexOf('twitter.com') !== -1 || ref.indexOf('t.co') !== -1)\n      return 'from-twitter';\n    else if (ref.indexOf('reddit.com') !== -1)\n      return 'from-reddit';\n    else if (window.location.href.indexOf('_src=ga') !== -1)\n      return 'from-google-adwords';\n    else if (ref.indexOf('google.com') !== -1)\n      return 'from-google';\n  }\n}\n\nwindow.components = window.components || {};\nwindow.components.forms = function (doc, win) {\n  /**\n   * Retrieves form data from Action Network API, then submits entry\n   * @param {object} doc - Document object\n   * @param {object} win - Window object\n   * */\n  \"use strict\";\n\n  var\n    body = doc.getElementsByTagName('body')[0],\n    submitButton = body.querySelector('[type=\"submit\"]'),\n    submitted = doc.createElement('div'),\n    countryLabel = doc.querySelector('[for=\"select-country\"]'),\n    countrySelect = doc.getElementById('select-country'),\n    countryInput = doc.getElementById('hidden-country'),\n    formComments = doc.getElementById('form-comments'),\n    commitmentForm = doc.forms[0];\n\n  submitted.classList.add('submitted');\n  submitted.innerHTML = '<div class=\"circle-spinner\">&nbsp;</div>';\n\n  function focusComments() {\n    formComments.className = 'focused';\n  }\n\n  function updateZIPPlaceholder() {\n    /**\n     * Updates placeholder on ZIP/Post Code field to be appropriate for country\n     * selected\n     * */\n    var\n      ZIPLabel = doc.getElementById('form-zip_code');\n\n    if (countrySelect.value !== 'US') {\n      ZIPLabel.setAttribute('placeholder', 'Post code');\n    } else {\n      ZIPLabel.setAttribute('placeholder', 'ZIP');\n    }\n  }\n\n  function toggleCountryField() {\n    /**\n     * Hides the label and shows the select when someone changes their signature\n     * country.\n     * */\n\n    countryInput.remove();\n    countrySelect.setAttribute('name', 'answer[country]');\n    countrySelect.classList.add('visible');\n    countryLabel.classList.add('hidden');\n  }\n\n  function removeForm() {\n    commitmentForm.setAttribute('style', 'height: ' + commitmentForm.clientHeight + 'px;');\n    win.setTimeout(function(){\n      commitmentForm.setAttribute('style', 'height: 0;');\n    }, 20)\n  }\n\n  function handleSigningError(e) {\n    /**\n     * Figures out what to say at just the right moment\n     * @param {event|XMLHttpRequest} e - Might be an event, might be a response\n     * from an XMLHttpRequest\n     * */\n\n    var\n      errorMessage = doc.createElement('h2'),\n      errorMessageInfo = doc.createElement('p');\n\n    commitmentForm.removeAttribute('disabled');\n    submitted.remove();\n    errorMessage.textContent = 'Something went wrong';\n    if (e.type) {\n      errorMessageInfo.textContent = 'There seems to be a problem somewhere in between your computer and our server. Might not be a bad idea to give it another try.';\n    } else if (e.status) {\n      errorMessageInfo.textContent = '(the nerdy info is that the server returned a status of \"' + e.status + '\" and said \"' + e.statusText + '\".)'\n    } else {\n      errorMessageInfo.textContent = 'this seems to be a weird error. the nerds have been alerted.';\n    }\n\n    win.modals.generateModal([errorMessage, errorMessageInfo]);\n\n    submitted.remove();\n    submitButton.removeAttribute('disabled');\n  }\n\n  function handleSigningSuccess() {\n    /**\n     * Figures out what to say at just the right moment\n     * @param {event|XMLHttpRequest} e - Might be an event, might be a response\n     * from an XMLHttpRequest\n     * */\n\n    var\n      modalContent = doc.createElement('div'),\n      share = doc.getElementsByClassName('share')[0];\n\n    console.log('share:' ,share);\n\n    share.classList.add('visible');\n    modalContent.innerHTML = '<h2>Thanks for signing</h2>\\n<p>Now, share this page to spread the word.</p><ul class=\"share inline visible\">\\n'+share.innerHTML+'</ul><p><small>…or, <a href=\"https://donate.fightforthefuture.org/?amount=5&frequency=just-once\">donate $5</a> to help us spread the message.</small></p>';\n\n    win.modals.generateModal([modalContent]);\n    removeForm();\n\n    document.querySelector('.modal-content button.facebook').addEventListener('click', FreeProgress.share.bind(FreeProgress));\n    document.querySelector('.modal-content button.google').addEventListener('click', googlePlus);\n    document.querySelector('.modal-content button.twitter').addEventListener('click', FreeProgress.tweet.bind(FreeProgress));\n  }\n\n  function submitForm(event) {\n    /**\n     * Submits the form to ActionNetwork.\n     * @param {event} event - Form submission event\n     * */\n\n    event.preventDefault();\n\n    var\n      commitmentStatus = new XMLHttpRequest();\n\n    commitmentForm.setAttribute('disabled', true);\n    submitted.classList.add('submitted');\n    submitButton.setAttribute('disabled', true);\n    commitmentForm.appendChild(submitted);\n\n    function compilePayload() {\n      /**\n       * Compiles the form data into a JSON payload for Ajax submission\n       * @return {object} petitionFormData - just the info the API needs\n       * */\n\n      var tags = JSON.parse(doc.querySelector('[name=\"subscription[tag_list]\"]').value);\n      if (util.getReferrerTag())\n        tags.push(util.getReferrerTag());\n\n      var formData = new FormData();\n      formData.append('guard', '');\n      formData.append('hp_enabled', true);\n      formData.append('org', 'fftf');\n      formData.append('tag', window.location.pathname);\n\n      formData.append('an_tags', JSON.stringify(tags));\n      formData.append('an_petition', commitmentForm.action.replace('/signatures', ''));\n\n      formData.append('member[email]', doc.getElementById('form-email').value);\n      formData.append('member[postcode]', doc.getElementById('form-zip_code').value);\n      formData.append('member[country]', countrySelect.value);\n\n      if (doc.getElementById('form-first_name')) {\n        formData.append('member[first_name]', doc.getElementById('form-first_name').value);\n      }\n\n      if (doc.getElementById('form-comments')) {\n        formData.append('action_comment', doc.getElementById('form-comments').value);\n      }\n\n      return formData;\n    }\n\n    function loadSignatureResponse() {\n      /**\n       * Does the thing after we get a response from the API server\n       * */\n\n      if (commitmentStatus.status >= 200 && commitmentStatus.status < 400) {\n        handleSigningSuccess();\n      } else {\n        handleSigningError(commitmentStatus);\n      }\n    }\n\n    commitmentStatus.open('POST', 'https://queue.fightforthefuture.org/action', true);\n    commitmentStatus.addEventListener('error', handleSigningError);\n    commitmentStatus.addEventListener('load', loadSignatureResponse);\n    commitmentStatus.send(compilePayload());\n\n    /*\n    var data = new FormData();\n    data.append('name', doc.getElementById('form-first_name').value);\n    data.append('comment', doc.getElementById('form-comments').value);\n\n    var xhr = new XMLHttpRequest();\n\n    xhr.onreadystatechange = function() {\n        if (xhr.readyState === 4)\n        {\n            if (xhr.status == 200)\n                console.log('SUCCESS:', xhr.response);\n            else\n                console.log('FAIL:', xhr.response);\n        }\n    }.bind(this);\n    xhr.open(\"post\", 'https://queue.fightforthefuture.org/stuff_regulations_gov', true);\n    xhr.send(data);\n    */\n\n    if (typeof ga !== 'undefined' && typeof window.VARIATION !== 'undefined') {\n      console.log('event', 'form', 'convert', window.VARIATION);\n      ga('send', 'event', 'form', 'convert', window.VARIATION);\n    }\n  }\n\n  function addEventListeners() {\n    /**\n     * Attaches all the listeners all the places\n     * */\n    countryLabel.addEventListener('click', toggleCountryField);\n    countrySelect.addEventListener('change', updateZIPPlaceholder);\n    commitmentForm.addEventListener('submit', submitForm);\n    formComments.addEventListener('focus', focusComments);\n  }\n\n  function init() {\n    addEventListeners();\n  }\n\n  init();\n  // setTimeout(function() { handleSigningSuccess() }, 500); // JL DEBUG ~\n};\n\n(function (doc, win) {\n  \"use strict\";\n\n  win.modals = win.modals || {};\n\n  var\n    i,\n    body = doc.getElementsByTagName('body')[0],\n    modalParent = doc.createElement('div');\n\n  modalParent.classList.add('modal-parent', 'fade-in');\n\n  function dismissModal() {\n    /**\n     * Removes modal from DOM\n     * */\n\n    var\n      modal = doc.getElementsByClassName('modal-content')[0];\n\n    doc.getElementsByClassName('overlay')[0].remove();\n    modal.removeAttribute('style');\n    modal.classList.add('off-screen');\n    win.setTimeout(function () {\n      modal.remove();\n    }, 420);\n  }\n\n  function generateModal(contents, disableOverlayClick) {\n    /**\n     * Triggers a modal\n     *\n     * @param {node} contents - any HTML to be used as modal content (also\n     *   accepts array of nodes)\n     * @param {boolean} disableOverlayClick - if false (or absent), function\n     *   adds event listener to allow dismissal of modal by clicking on\n     *   overlay.\n     * */\n\n    var\n      overlay = doc.createElement('div'),\n      modal = doc.createElement('div'),\n      closeModal;\n\n    if (contents.length === undefined) {\n      contents = [contents];\n    }\n\n    if (typeof disableOverlayClick !== 'boolean') {\n      disableOverlayClick = false;\n    }\n\n    overlay.id = disableOverlayClick ? 'no-click-for-you' : 'dismiss-me';\n    overlay.classList.add('overlay');\n    modal.classList.add('modal-content');\n\n    if (!disableOverlayClick) {\n      closeModal = doc.createElement('button');\n      closeModal.classList.add('close-modal');\n      closeModal.innerHTML = '&times;';\n      modal.appendChild(closeModal);\n      closeModal.addEventListener('click', dismissModal);\n      overlay.addEventListener('click', dismissModal);\n    }\n\n    for (i = 0; i < contents.length; i++) {\n      modal.appendChild(contents[i]);\n    }\n\n    modalParent.appendChild(overlay);\n    modalParent.appendChild(modal);\n    body.appendChild(modalParent);\n\n    win.setTimeout(function () {\n      modalParent.classList.remove('fade-in');\n    }, 500);\n  }\n\n  function noConnectionModal() {\n    /**\n     * noConnectionModal();\n     * Triggers a modal which reads:\n     * > Something went wrong.\n     * > Do you have a network connection?\n     * */\n\n    dismissModal();\n    var\n      message = doc.createElement('h2');\n\n    message.innerHTML = 'Something went wrong.<br />Do you have a network connection?';\n    generateModal([message]);\n  }\n\n  win.modals.dismissModal = dismissModal;\n  win.modals.generateModal = generateModal;\n  win.modals.noConnectionModal = noConnectionModal;\n\n\n}(document, window));\n\n\n\n/******************** *\n * FFTF Donate Modals *\n ******************** */\n(function (doc, win) {\n  \"use strict\";\n\n  win.modals = win.modals || {};\n\n  var\n    i,\n    body = doc.getElementsByTagName('body')[0],\n    modalParent = doc.createElement('div');\n\n  modalParent.classList.add('modal-parent');\n\n  function dismissModal() {\n    /**\n     * Removes modal from DOM\n     * */\n\n    var\n      modal = doc.getElementsByClassName('modal-parent')[0];\n\n    modal.setAttribute('style', 'opacity: 0');\n\n    win.setTimeout(function () {\n      modal.remove();\n    }, 420);\n  }\n\n  function generateModal(contents, disableOverlayClick) {\n    /**\n     * Triggers a modal\n     *\n     * @param {node} contents - any HTML to be used as modal content (also\n     *   accepts array of nodes)\n     * @param {boolean} disableOverlayClick - if false (or absent), function\n     *   adds event listener to allow dismissal of modal by clicking on\n     *   overlay.\n     * */\n\n    var\n      overlay = doc.createElement('div'),\n      modal = doc.createElement('div'),\n      closeModal;\n\n    if (contents.length === undefined) {\n      contents = [contents];\n    }\n\n    if (typeof disableOverlayClick !== 'boolean') {\n      disableOverlayClick = false;\n    }\n\n    overlay.id = disableOverlayClick ? 'no-click-for-you' : 'dismiss-me';\n    overlay.classList.add('overlay');\n    modal.classList.add('modal-content', 'off-screen');\n\n    if (!disableOverlayClick) {\n      closeModal = doc.createElement('button');\n      closeModal.classList.add('close-modal');\n      closeModal.innerHTML = '&times;';\n      modal.appendChild(closeModal);\n      closeModal.addEventListener('click', dismissModal);\n      overlay.addEventListener('click', dismissModal);\n    }\n\n    for (i = 0; i < contents.length; i++) {\n      modal.appendChild(contents[i]);\n    }\n\n    modalParent.appendChild(overlay);\n    modalParent.appendChild(modal);\n    body.appendChild(modalParent);\n\n    win.setTimeout(function () {\n      modal.classList.remove('off-screen');\n    }, 50);\n  }\n\n  function noConnectionModal() {\n    /**\n     * noConnectionModal();\n     * Triggers a modal which reads:\n     * > Something went wrong.\n     * > Do you have a network connection?\n     * */\n\n    dismissModal();\n    var\n      message = doc.createElement('h2');\n\n    message.innerHTML = 'Something went wrong.<br />Do you have a network connection?';\n    generateModal([message]);\n  }\n\n  win.modals.dismissModal = dismissModal;\n  win.modals.generateModal = generateModal;\n  win.modals.noConnectionModal = noConnectionModal;\n\n\n}(document, window));\n\n(function (doc, win) {\n  win.views = win.views || {};\n  win.views.modals = {}}(document, window));\n\nvar $c  = document.createElement.bind(document);\n\nfunction googlePlus() {\n  var url = window.location.protocol + '//' + window.location.host;\n  window.open('https://plus.google.com/share?url='+url, 'share_gl', 'width=500, height=300, toolbar=no, status=no, menubar=no');\n}\n\n(function (doc, win) {\n  \"use strict\";\n\n  function triggerComponents() {\n    win.components = win.components || {};\n    var\n      i = 0,\n      components = doc.getElementsByTagName('body')[0].dataset.components;\n\n    if (components !== undefined) {\n      components = components.split(' ');\n      i = components.length;\n\n      while (i--) {\n        if (components[i] !== '' && win.components[components[i]] !== undefined) {\n          win.components[components[i]](doc, win);\n        }\n      }\n    }\n  }\n\n  triggerComponents();\n\n  var shareVisibilityTriggered = false;\n  var headlineEl  = document.getElementById('obama-stop-the-nsa'),\n      bodyRect    = document.body.getBoundingClientRect(),\n      elemRect    = headlineEl ? headlineEl.getBoundingClientRect() : null,\n      headlineY   = elemRect ? (elemRect.top - bodyRect.top) : null;\n\n  var listenerFn = function() {\n    var top   = ((window.pageYOffset||doc.scrollTop)-(doc.clientTop||0)||0),\n        alpha = 1-(top/headlineY);\n\n    if (alpha < 0) alpha = 0;\n\n    document.body.style.backgroundColor = 'rgba(15,22,32,'+alpha+')';\n\n\n    if (top > 300 && shareVisibilityTriggered == false) {\n      shareVisibilityTriggered = true;\n      document.querySelector('ul.share').classList.add('visible');\n    }\n  };\n\n\n  // JL HACK ~ disable countdown\n  if (doc.body.className.indexOf('content') === -1) {\n    listenerFn();\n    window.addEventListener('scroll', listenerFn);\n  }\n\n\n  if (doc.querySelector('[href=\"#obama-stop-the-nsa\"]'))\n    doc.querySelector('[href=\"#obama-stop-the-nsa\"]').addEventListener('click', function (e){\n      e.preventDefault();\n\n      win.smoothScroll(doc.getElementById('obama-stop-the-nsa'));\n    });\n\n\n  var gl = document.querySelectorAll('button.google');\n    for (var i = 0; i < gl.length; i++) {\n        gl[i].addEventListener('click', function(e) {\n            e.preventDefault();\n            googlePlus();\n        }, false);\n    }\n\n  // COUNTDOWN TO FUN\n\n  function Countdown() {\n    this.date = new Date(Date.UTC(2017, 00, 20, 5, 00, 0)).getTime();\n    this.interval = null;\n    this.requestAnimationFrame = this.requestAnimationFrame.bind(this);\n    this.targets = {};\n    this.tick = this.tick.bind(this);\n    this.curTick = false;\n    this.start();\n  }\n\n  Countdown.prototype.constants = {\n    day: (1000 * 60 * 60 * 24),\n    hour: (1000 * 60 * 60),\n    minute: (1000 * 60),\n    second: (1000)\n  };\n\n  Countdown.prototype.padNumber = function(number) {\n    if (number > 9) {\n      return number;\n    } else {\n      return '0' + number;\n    }\n  };\n\n  Countdown.prototype.requestAnimationFrame = function() {\n    var request = window.requestAnimationFrame || setTimeout;\n    request(this.tick);\n  };\n\n  Countdown.prototype.start = function() {\n    this.stop();\n    this.requestAnimationFrame();\n    this.interval = setInterval(this.requestAnimationFrame, 1000);\n  };\n\n  Countdown.prototype.stop = function() {\n    clearInterval(this.interval);\n  };\n\n  Countdown.prototype.tick = function() {\n    var now = Date.now();\n    var difference = this.date - now;\n\n    this.updateDates(difference);\n\n    if (difference < 0) {\n      this.stop();\n      document.getElementById('remaining').textContent = '00.00:00:00';\n    }\n  };\n\n  Countdown.prototype.updateDates = function(difference) {\n\n    this.curTick = !this.curTick;\n    var c = this.curTick;\n\n    var days = Math.floor(difference / this.constants.day);\n    difference -= days * this.constants.day;\n\n    var hours = Math.floor(difference / this.constants.hour);\n    difference -= hours * this.constants.hour;\n\n    var minutes = Math.floor(difference / this.constants.minute);\n    difference -= minutes * this.constants.minute;\n\n    var seconds = Math.floor(difference / this.constants.second);\n    difference -= seconds * this.constants.second;\n\n    /*\n    var str =   this.padNumber(days)\n    +(c ? '.' : '.')+this.padNumber(hours)\n    +(c ? ':' : ' ')+this.padNumber(minutes)\n    +(c ? ':' : ' ')+this.padNumber(seconds);\n    */\n    var str =   this.padNumber(days)\n    +'.'+this.padNumber(hours)\n    +':'+this.padNumber(minutes)\n    +':'+this.padNumber(seconds);\n\n    document.getElementById('remaining').textContent = str;\n  };\n\n  new Countdown(); // JL HACK ~ disabled\n\n\n\n})(document, window);\n\n//# sourceMappingURL=core.js.map"]}